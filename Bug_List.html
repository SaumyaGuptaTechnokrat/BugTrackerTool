<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bug Tickets</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f4f4f4;
    }

    .section {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
    }

    h2 {
      text-align: center;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    table, th, td {
      border: 1px solid #ccc;
    }

    th, td {
      padding: 10px;
      text-align: left;
    }

    .screenshot-preview {
      max-width: 100px;
      cursor: pointer;
    }

    select, button {
      padding: 8px;
      margin-right: 10px;
      margin-top: 10px;
    }

    .link {
      text-align: center;
      margin-top: 20px;
    }

    .link a {
      text-decoration: none;
      color: #007bff;
    }
  </style>
</head>
<body>

  <div class="section">
    <h2>üêû Bug Tickets</h2>

    <label>Filter by User:</label>
    <select id="filterUser">
      <option value="">All</option>
      <option value="Alice">Alice</option>
      <option value="Bob">Bob</option>
      <option value="Charlie">Charlie</option>
      <option value="Dave">Dave</option>
    </select>
    <button id="applyFilter">Apply</button>
    <button id="resetFilter">Reset</button>

    <table id="bugTable">
      <thead>
        <tr>
          <th>User</th>
          <th>Team</th>
          <th>Priority</th>
          <th>Title</th>
          <th>Steps</th>
          <th>Expected</th>
          <th>Actual</th>
          <th>Date</th>
          <th>Screenshot</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div class="link">
      <a href="Bug_add.html">‚ûï Add New Bug</a>
    </div>
  </div>

<script>
  const bugs = JSON.parse(localStorage.getItem("bugs")) || [];

  function renderTable(data) {
    const tbody = $("#bugTable tbody");
    tbody.empty();

    if (data.length === 0) {
      tbody.append("<tr><td colspan='9'>No bugs found.</td></tr>");
      return;
    }

    data.forEach(bug => {
      const screenshot = bug.screenshot
        ? `<img src="${bug.screenshot}" class="screenshot-preview" onclick="window.open('${bug.screenshot}', '_blank')">`
        : "N/A";

      const row = `
        <tr>
          <td>${bug.user}</td>
          <td>${bug.team}</td>
          <td>${bug.priority}</td>
          <td>${bug.title}</td>
          <td>${bug.steps}</td>
          <td>${bug.expected}</td>
          <td>${bug.actual}</td>
          <td>${bug.date}</td>
          <td>${screenshot}</td>
        </tr>
      `;
      tbody.append(row);
    });
  }

  $("#applyFilter").click(() => {
    const user = $("#filterUser").val();
    const filtered = user ? bugs.filter(b => b.user === user) : bugs;
    renderTable(filtered);
  });

  $("#resetFilter").click(() => {
    $("#filterUser").val("");
    renderTable(bugs);
  });

  // Initial load
  renderTable(bugs);
</script>
</body>
</html>
